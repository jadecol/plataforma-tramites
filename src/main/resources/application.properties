# Configuracion de la base de datos PostgreSQL
spring.datasource.url=jdbc:postgresql://localhost:5432/plataforma_tramites_db
spring.datasource.username=postgres
spring.datasource.password=Super2050*
spring.datasource.driver-class-name=org.postgresql.Driver

# Configuracion de JPA/Hibernate
# TEMPORALMENTE cambiado a 'create' ya que Flyway está deshabilitado
spring.jpa.hibernate.ddl-auto=create
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect

# Esto es importante para que JPA entienda como manejar las columnas SERIAL/BIGSERIAL en PostgreSQL
spring.jpa.properties.hibernate.id.new-generator-mappings=false
spring.jpa.defer-datasource-initialization=true

# Configuración Flyway - TEMPORALMENTE DESHABILITADO para resolver dependencia circular
spring.flyway.enabled=false
# spring.flyway.baseline-on-migrate=true
# spring.flyway.out-of-order=true

# Configuracion JWT - SECRET temporal para MVP (HS512 requires >= 512 bits = 64 chars)
jwt.secret=${JWT_SECRET:MySecureJwtKeyForPlataformaTramites2024WithEnoughBitsForHS512Algorithm123456789}
jwt.expiration=86400000

# Puerto del servidor web (opcional, por defecto es 8080)
server.port=8080

# Configuracion de Logging para depuracion (¡CLAVE para el 400 Bad Request!)
# Ajusta 'com.gestion.tramites' a tu paquete base
logging.level.com.gestion.tramites=DEBUG
logging.level.org.springframework.web=DEBUG
# Ver errores de parsing JSON
logging.level.com.fasterxml.jackson.databind=DEBUG
# Ver errores de validación (@Valid) 
logging.level.org.springframework.validation=DEBUG
# Para ver más detalles de las consultas SQL
logging.level.org.hibernate.SQL=DEBUG
# Para ver los parámetros que se pasan a SQL
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE

# Configuración de Email (SMTP) - CON DEFAULTS PARA MVP
spring.mail.host=${SMTP_HOST:smtp.gmail.com}
spring.mail.port=${SMTP_PORT:587}
spring.mail.username=${SMTP_USERNAME:test@example.com}
spring.mail.password=${SMTP_PASSWORD:testpassword}
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.starttls.required=true
spring.mail.properties.mail.smtp.ssl.trust=*

# Configuración de notificaciones
notifications.email.enabled=${NOTIFICATIONS_ENABLED:true}
notifications.email.from=${NOTIFICATIONS_FROM_EMAIL:noreply@plataforma-tramites.gov.co}
notifications.email.from-name=${NOTIFICATIONS_FROM_NAME:Plataforma de Trámites}
notifications.email.base-url=${BASE_URL:http://localhost:8080}

# Configuración de documentos
documents.storage.path=${DOCUMENTS_STORAGE_PATH:./storage/documents}
documents.max-file-size=${DOCUMENTS_MAX_FILE_SIZE:50MB}
documents.max-request-size=${DOCUMENTS_MAX_REQUEST_SIZE:100MB}
documents.allowed-extensions=${DOCUMENTS_ALLOWED_EXTENSIONS:pdf,doc,docx,jpg,jpeg,png,gif,dwg,dxf,xlsx,xls,zip,rar}
documents.max-files-per-tramite=${DOCUMENTS_MAX_FILES_PER_TRAMITE:50}
documents.max-total-size-per-tramite=${DOCUMENTS_MAX_TOTAL_SIZE_PER_TRAMITE:500MB}

# Configuración de Spring Boot para archivos
spring.servlet.multipart.max-file-size=${documents.max-file-size}
spring.servlet.multipart.max-request-size=${documents.max-request-size}